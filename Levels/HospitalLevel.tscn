[gd_scene load_steps=23 format=3 uid="uid://h8f6xyr320jw"]

[ext_resource type="Script" path="res://Classes/test_level.gd" id="1_lb5ks"]
[ext_resource type="Script" path="res://Classes/Floor.gd" id="2_8jama"]
[ext_resource type="Material" uid="uid://cbnt1e0vv63fc" path="res://Materials/brick.tres" id="2_swwn4"]
[ext_resource type="Material" uid="uid://b6mu812ltpnvq" path="res://Materials/wall.tres" id="4_alsgf"]
[ext_resource type="PackedScene" uid="uid://dvwx4paulp02r" path="res://Entities/Player.tscn" id="5_11qjr"]

[sub_resource type="BoxMesh" id="BoxMesh_mf8x4"]
material = ExtResource("2_swwn4")
size = Vector3(11, 0.1, 22)

[sub_resource type="BoxMesh" id="BoxMesh_wd2uy"]
material = ExtResource("2_swwn4")
size = Vector3(11, 0.1, 22)

[sub_resource type="BoxMesh" id="BoxMesh_13oyj"]
material = ExtResource("4_alsgf")
size = Vector3(0.2, 3, 6)

[sub_resource type="BoxMesh" id="BoxMesh_xe516"]
material = ExtResource("4_alsgf")
size = Vector3(0.2, 3, 4)

[sub_resource type="BoxMesh" id="BoxMesh_kcw5k"]
material = ExtResource("4_alsgf")
size = Vector3(0.2, 3, 11)

[sub_resource type="BoxMesh" id="BoxMesh_hf2po"]
material = ExtResource("4_alsgf")
size = Vector3(0.2, 3, 3)

[sub_resource type="BoxMesh" id="BoxMesh_m7jg3"]
material = ExtResource("4_alsgf")
size = Vector3(0.2, 3, 3)

[sub_resource type="BoxMesh" id="BoxMesh_67m8p"]
material = ExtResource("4_alsgf")
size = Vector3(0.2, 3, 6)

[sub_resource type="BoxMesh" id="BoxMesh_mmttn"]
material = ExtResource("4_alsgf")
size = Vector3(0.2, 3, 11)

[sub_resource type="BoxMesh" id="BoxMesh_b35et"]
material = ExtResource("4_alsgf")
size = Vector3(0.2, 3, 3.4)

[sub_resource type="BoxMesh" id="BoxMesh_ax8mk"]
material = ExtResource("4_alsgf")
size = Vector3(0.2, 3, 2.9)

[sub_resource type="BoxMesh" id="BoxMesh_d1sas"]
material = ExtResource("4_alsgf")
size = Vector3(0.2, 3, 6)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ci7e5"]
transparency = 1
shading_mode = 0
albedo_color = Color(1, 1, 1, 0.196078)

[sub_resource type="SphereMesh" id="SphereMesh_i7wk1"]
material = SubResource("StandardMaterial3D_ci7e5")
radial_segments = 16
rings = 8

[sub_resource type="Shader" id="Shader_3sqrf"]
code = "shader_type spatial;
render_mode unshaded;

uniform sampler2D SCREEN_TEXTURE: hint_screen_texture, filter_linear_mipmap;
uniform sampler2D DEPTH_TEXTURE : source_color, hint_depth_texture;

uniform float depth_range:hint_range(0.1, 100.0, 0.1);

void vertex(){
	POSITION = vec4(VERTEX, 1.0);
}

void fragment() {
	vec2 uv = SCREEN_UV;
	
	vec3 screen_color = texture(SCREEN_TEXTURE, uv).rgb;
	
	float depth = texture(DEPTH_TEXTURE, SCREEN_UV).x;
	vec3 ndc = vec3(SCREEN_UV * 2.0 - 1.0, depth);
	vec4 view = INV_PROJECTION_MATRIX * vec4(ndc, 1.0);
	view.xyz /= view.w;
	float linear_depth = -view.z / depth_range;
	
	// your code goes here!
	
	vec3 fog = vec3(linear_depth) * vec3(100./255.,110.0/255.0,250.0/255.0);
	vec3 final_color = fog + screen_color;
	
	ALBEDO = final_color;
	ALPHA = screen_color.b;
	
	// example outputs
	
	//ALBEDO = vec3(linear_depth); 	// showing depth texture
	//ALBEDO = normal; 				// showing normal texture
	//ALBEDO = vec3(roughness); 	// showing roughness texture
	ALBEDO = final_color;		// showing screen texture
}"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_34wh1"]
render_priority = 0
shader = SubResource("Shader_3sqrf")
shader_parameter/depth_range = 25.0

[sub_resource type="QuadMesh" id="QuadMesh_8uww4"]
material = SubResource("ShaderMaterial_34wh1")
flip_faces = true
size = Vector2(2, 2)

[node name="LevelHome" type="Node3D"]
script = ExtResource("1_lb5ks")

[node name="Collidable" type="Node3D" parent="."]

[node name="Floor" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.05, 5.5)
mesh = SubResource("BoxMesh_mf8x4")
script = ExtResource("2_8jama")
step_sound = "Placeholder"

[node name="Floor2" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.05, 5.5)
mesh = SubResource("BoxMesh_wd2uy")
script = ExtResource("2_8jama")
step_sound = "Placeholder"

[node name="MeshInstance3D" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(0.999995, 0.00306397, 0.00109848, -0.00306207, 0.999994, -0.00172425, -0.00110377, 0.00172087, 0.999998, -2, 1.5, 2.5)
mesh = SubResource("BoxMesh_13oyj")

[node name="MeshInstance3D3" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 3.5, 1.5, 5.6)
mesh = SubResource("BoxMesh_xe516")

[node name="MeshInstance3D9" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -3.5, 1.5, 5.6)
mesh = SubResource("BoxMesh_xe516")

[node name="MeshInstance3D6" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, 1.5, -5.6)
mesh = SubResource("BoxMesh_kcw5k")

[node name="MeshInstance3D11" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, 1.5, 16.6)
mesh = SubResource("BoxMesh_kcw5k")

[node name="MeshInstance3D7" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, -5.6, 1.5, 8.9407e-08)
mesh = SubResource("BoxMesh_kcw5k")

[node name="MeshInstance3D8" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 5.6, 1.5, 8.9407e-08)
mesh = SubResource("BoxMesh_kcw5k")

[node name="MeshInstance3D2" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(0.999995, 0.00306397, 0.00109848, -0.00306207, 0.999994, -0.00172425, -0.00110377, 0.00172087, 0.999998, 2, 1.5, 4)
mesh = SubResource("BoxMesh_hf2po")

[node name="MeshInstance3D4" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(0.999995, 0.00306397, 0.00109848, -0.00306207, 0.999994, -0.00172425, -0.00110377, 0.00172087, 0.999998, -2, 1.5, -4)
mesh = SubResource("BoxMesh_m7jg3")

[node name="MeshInstance3D5" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(0.999995, 0.00306397, 0.00109848, -0.00306207, 0.999994, -0.00172425, -0.00110377, 0.00172087, 0.999998, 2, 1.5, -2.5)
mesh = SubResource("BoxMesh_67m8p")

[node name="MeshInstance3D10" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(0.999995, 0.00306397, 0.00109848, -0.00306207, 0.999994, -0.00172425, -0.00110377, 0.00172087, 0.999998, 2, 1.5, 13.5)
mesh = SubResource("BoxMesh_13oyj")

[node name="MeshInstance3D14" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, -5.6, 1.5, 11)
mesh = SubResource("BoxMesh_mmttn")

[node name="MeshInstance3D15" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 5.6, 1.5, 11)
mesh = SubResource("BoxMesh_kcw5k")

[node name="MeshInstance3D16" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(0.999995, 0.00306397, 0.00109848, -0.00306207, 0.999994, -0.00172425, -0.00110377, 0.00172087, 0.999998, -2, 1.5, 15)
mesh = SubResource("BoxMesh_hf2po")

[node name="MeshInstance3D19" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(0.00110373, -0.00172087, -0.999998, -0.00306207, 0.999994, -0.00172425, 0.999995, 0.00306397, 0.00109844, -3.8, 1.5, 10)
mesh = SubResource("BoxMesh_b35et")

[node name="MeshInstance3D17" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(0.999995, 0.00306397, 0.00109848, -0.00306207, 0.999994, -0.00172425, -0.00110377, 0.00172087, 0.999998, 2, 1.5, 7.15)
mesh = SubResource("BoxMesh_ax8mk")

[node name="MeshInstance3D18" type="MeshInstance3D" parent="Collidable"]
transform = Transform3D(0.999995, 0.00306397, 0.00109848, -0.00306207, 0.999994, -0.00172425, -0.00110377, 0.00172087, 0.999998, -2, 1.5, 8.7)
mesh = SubResource("BoxMesh_d1sas")

[node name="CPUParticles3D" type="CPUParticles3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
amount = 360
lifetime = 5.0
preprocess = 3.0
randomness = 0.2
mesh = SubResource("SphereMesh_i7wk1")
emission_shape = 3
emission_box_extents = Vector3(11, 1, 11)
direction = Vector3(0, 1, 0)
spread = 0.0
gravity = Vector3(0, 0, 0)
initial_velocity_min = 0.05
initial_velocity_max = 0.3
linear_accel_min = -0.1
linear_accel_max = 0.1
damping_max = 0.005
scale_amount_min = 0.02
scale_amount_max = 0.03

[node name="CPUParticles3D2" type="CPUParticles3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 4, 0)
amount = 360
lifetime = 5.0
preprocess = 3.0
randomness = 0.2
mesh = SubResource("SphereMesh_i7wk1")
emission_shape = 3
emission_box_extents = Vector3(11, 1, 11)
direction = Vector3(0, 1, 0)
spread = 0.0
gravity = Vector3(0, 0, 0)
initial_velocity_min = 0.05
initial_velocity_max = 0.3
linear_accel_min = -0.1
linear_accel_max = 0.1
damping_max = 0.005
scale_amount_min = 0.02
scale_amount_max = 0.03

[node name="Player" parent="." instance=ExtResource("5_11qjr")]
transform = Transform3D(1, 0, 1.06581e-14, 0, 1, 0, -1.06581e-14, 0, 1, -0.00100005, 0, 14.303)

[node name="FogShader" parent="Player/Neck" index="0"]
mesh = SubResource("QuadMesh_8uww4")

[node name="Lights" type="Node3D" parent="."]

[node name="SpotLight3D" type="SpotLight3D" parent="Lights"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 3, 12.7)
spot_range = 10.0
spot_angle = 60.0

[node name="SpotLight3D2" type="SpotLight3D" parent="Lights"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 3, 8)
spot_range = 10.0
spot_angle = 60.0

[node name="SpotLight3D3" type="SpotLight3D" parent="Lights"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 3, 4)
spot_range = 10.0
spot_angle = 60.0

[node name="SpotLight3D4" type="SpotLight3D" parent="Lights"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 3, -1.6)
spot_range = 10.0
spot_angle = 60.0

[editable path="Player"]
[editable path="Player/QuitWindow"]
